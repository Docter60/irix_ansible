- name: install openssh bundle
  telnet:
    user: root
    password: 
    login_prompt: "login: "
    prompts:
      - "[>|#]"
    command:
      - "inst -a -f /tmp/openssh_bundle/neko_openssh-6.2p1.tardist \
      -a -f /tmp/openssh_bundle/neko_openssl-0.9.8x.tardist \
      -a -f /tmp/openssh_bundle/neko_zlib-1.2.5.tardist"
  register: installout

- name: print output
  debug: 
    msg: "{{ installout }}"


- name: install wget bundle
  telnet:
    user: root
    password: 
    login_prompt: "login: "
    prompts:
      - "[>|#]"
    command:
      - "cd /tmp/wget_bundle ; inst -a -f neko_wget-1.11.3.tardist \
      -a -f neko_gettext-0.18.1.1.tardist \
      -a -f neko_glib-2.28.8-11.tardist \
      -a -f neko_libcroco-0.6.2-5.tardist \
      -a -f neko_libiconv-1.14.tardist \
      -a -f neko_libxml2-2.7.8.tardist \
      -a -f neko_ncurses-5.7.tardist \
      -a -f neko_openssl-0.9.8x.tardist \
      -a -f neko_zlib-1.2.5.tardist"
  register: installout

- name: print output
  debug: 
    msg: "{{ installout }}"

- name: copy python installer
  raw: curl -T roles/bootstrap/files/python_install.sh ftp://{{ansible_host}} --user ansible:ansible

- name: install python bundle
  telnet:
    user: root
    password:
    login_prompt: "login: "
    prompts:
      - "[>|#]"
    command:
      - "/sbin/sh /usr/people/ansible/python_install.sh"

- name: Verify python
  telnet:
    user: root
    password:
    login_prompt: "login: "
    prompts:
      - "[>|#]"
    command:
      - "/usr/nekoware/bin/python --version"
  register: pyversion

# - name: print output
#   debug:
#     msg: "{{ pyversion }}"

- name: Failure
  fail:
    msg: "Python failed to install properly"
  when: pyversion.output | select('search','Python') | list | count < 0
  # per debug, telnet's output is a list. We have to select search it, then count it.